<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Regular expressions in pattern matching</title>
        <link rel="stylesheet" type="text/css" href="../css/style.css" />
        <link rel="stylesheet" type="text/css" href="../css/fontjolly.css" />
        <link rel="icon" type="image/png" href="../images/favicon.png">
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Home</a>
                <a href="../archive.html">Archives</a>
            </div>
            <div id="navigation">
                <a title="GitHub" href="https://github.com/nrinaudo"><span class="ico-social-github"></span></a>
                <a title="Twitter" href="https://twitter.com/NicolasRinaudo"><span class="ico-social-twitter"></span></a>
                <a title="Stack Overflow" href="http://stackoverflow.com/users/1370349/nicolas-rinaudo"><span class="ico-line-chart"></span></a>
            </div>
        </div>

        <div id="content">
            <h1>Regular expressions in pattern matching</h1>
<div class="info"><span class="date">2013-09-21</span><span class="tags"><a href="../tags/scala.html" class="tag">scala</a></span></div>
<p>While reading <code>Regex</code>’s <a href="http://www.scala-lang.org/files/archive/nightly/docs/library/index.html#scala.util.matching.Regex">documentation</a>, I discovered that it had a legal <code>unapplySeq</code> implementation. This means that it can be used in pattern matching, which I’m not sure is going to be terribly useful but is certainly very cool.</p>
<!--more-->

<p>The most immediate use of <code>Regex</code>’s <code>unapplySeq</code> method is to let us write code like this:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="co">// The usual 2D point class, with a horizontal and vertical coordinate.</span>
<span class="kw">case</span> <span class="kw">class</span> <span class="fu">Point</span>(x: <span class="dt">Int</span> = <span class="dv">0</span>, y: <span class="dt">Int</span> = <span class="dv">0</span>) {
  <span class="co">// Note the .r at the end of each line, which transforms a string into an instance of Regex</span>
  <span class="kw">private</span> <span class="kw">val</span> left   = <span class="st">&quot;left ([0-9]+)&quot;</span>.<span class="fu">r</span>
  <span class="kw">private</span> <span class="kw">val</span> right  = <span class="st">&quot;right ([0-9]+)&quot;</span>.<span class="fu">r</span>
  <span class="kw">private</span> <span class="kw">val</span> top    = <span class="st">&quot;top ([0-9]+)&quot;</span>.<span class="fu">r</span>
  <span class="kw">private</span> <span class="kw">val</span> bottom = <span class="st">&quot;bottom ([0-9]+)&quot;</span>.<span class="fu">r</span>

  <span class="co">// The beauty of pattern matching with regular expressions.</span>
  <span class="kw">def</span> <span class="fu">handle</span>(s: <span class="dt">String</span>): <span class="dt">Point</span> = s <span class="kw">match</span> {
    <span class="kw">case</span> <span class="fu">left</span>(p)   =&gt; <span class="fu">Point</span>(x - p.<span class="fu">toInt</span>, y)
    <span class="kw">case</span> <span class="fu">right</span>(p)  =&gt; <span class="fu">Point</span>(x + p.<span class="fu">toInt</span>, y)
    <span class="kw">case</span> <span class="fu">top</span>(p)    =&gt; <span class="fu">Point</span>(x, y - p.<span class="fu">toInt</span>)
    <span class="kw">case</span> <span class="fu">bottom</span>(p) =&gt; <span class="fu">Point</span>(x, y + p.<span class="fu">toInt</span>)
  }
}

<span class="co">// Prints 'Point(-10,5)'</span>
<span class="fu">println</span>(<span class="fu">Point</span>().<span class="fu">handle</span>(<span class="st">&quot;left 10&quot;</span>).<span class="fu">handle</span>(<span class="st">&quot;bottom 5&quot;</span>))</code></pre>
<p>Since extractor (<code>unapply</code> or <code>unapplySeq</code>) methods can be used at variable declaration time, you can also write things like:</p>
<pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">val</span> point = <span class="st">&quot;</span><span class="ch">\\</span><span class="st">(([0-9]+),([0-9]+)</span><span class="ch">\\</span><span class="st">)&quot;</span>.<span class="fu">r</span>

<span class="co">// It might be because I haven't seen this pattern enough yet, but I always read this as calling a function</span>
<span class="co">// on variables that haven't been defined yet.</span>
<span class="kw">val</span> <span class="fu">point</span>(x, y) = <span class="st">&quot;(10,12)&quot;</span>

<span class="co">// Prints '10 / 12'</span>
<span class="fu">println</span>(<span class="st">&quot;%s / %s&quot;</span> <span class="fu">format</span> (x, y))</code></pre>
<p>Note that you must be absolutely 100% confident that regular expression will match, as this will throw an exception otherwise.</p>

        </div>
    </body>
</html>
